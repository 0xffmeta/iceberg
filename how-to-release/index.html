<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    <link rel="canonical" href="https://iceberg.apache.org/how-to-release/">
    <link rel="shortcut icon" href="../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>How To Release - Apache Iceberg</title>
    <link href="../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/highlight.css">
    <link href="../css/extra.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../js/jquery-3.2.1.min.js"></script>
    <script src="../js/bootstrap-3.3.7.min.js"></script>
    <script src="../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Setup", url: "#_top", children: [
              {title: "Nexus access", url: "#nexus-access" },
              {title: "PGP signing", url: "#pgp-signing" },
          ]},
          {title: "Creating a release candidate", url: "#creating-a-release-candidate", children: [
              {title: "Build the source release", url: "#build-the-source-release" },
              {title: "Build and stage convenience binaries", url: "#build-and-stage-convenience-binaries" },
              {title: "Start a VOTE thread", url: "#start-a-vote-thread" },
              {title: "Finishing the release", url: "#finishing-the-release" },
          ]},
        ];

    </script>
    <script src="../js/base.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    <!--
 - Licensed to the Apache Software Foundation (ASF) under one or more
 - contributor license agreements.  See the NOTICE file distributed with
 - this work for additional information regarding copyright ownership.
 - The ASF licenses this file to You under the Apache License, Version 2.0
 - (the "License"); you may not use this file except in compliance with
 - the License.  You may obtain a copy of the License at
 -
 -   http://www.apache.org/licenses/LICENSE-2.0
 -
 - Unless required by applicable law or agreed to in writing, software
 - distributed under the License is distributed on an "AS IS" BASIS,
 - WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 - See the License for the specific language governing permissions and
 - limitations under the License.
 -->

<h2 id="setup">Setup<a class="headerlink" href="#setup" title="Permanent link">&para;</a></h2>
<p>To create a release candidate, you will need:</p>
<ul>
<li>Apache LDAP credentals for Nexus and SVN</li>
<li>A <a href="https://www.apache.org/dev/release-signing#generate">GPG key for signing</a>, published in <a href="https://dist.apache.org/repos/dist/dev/iceberg/KEYS">KEYS</a></li>
</ul>
<h3 id="nexus-access">Nexus access<a class="headerlink" href="#nexus-access" title="Permanent link">&para;</a></h3>
<p>Nexus credentials are configured in your personal <code>~/.gradle/gradle.properties</code> file using <code>mavenUser</code> and <code>mavenPassword</code>:</p>
<pre><code>mavenUser=yourApacheID
mavenPassword=SomePassword
</code></pre>
<h3 id="pgp-signing">PGP signing<a class="headerlink" href="#pgp-signing" title="Permanent link">&para;</a></h3>
<p>The release scripts use the command-line <code>gpg</code> utility so that signing can use the gpg-agent and does not require writing your private key&rsquo;s passphrase to a configuration file.</p>
<p>To configure gradle to sign convenience binary artifacts, add the following settings to <code>~/.gradle/gradle.properties</code>:</p>
<pre><code>signing.gnupg.keyName=Your Name (CODE SIGNING KEY)
</code></pre>
<p>To use <code>gpg</code> instead of <code>gpg2</code>, also set <code>signing.gnupg.executable=gpg</code></p>
<p>For more information, see the Gradle <a href="https://docs.gradle.org/current/userguide/signing_plugin.html#sec:signatory_credentials">signing documentation</a>.</p>
<h2 id="creating-a-release-candidate">Creating a release candidate<a class="headerlink" href="#creating-a-release-candidate" title="Permanent link">&para;</a></h2>
<h3 id="build-the-source-release">Build the source release<a class="headerlink" href="#build-the-source-release" title="Permanent link">&para;</a></h3>
<p>To create the source release artifacts, run the <code>source-release.sh</code> script with the release version and release candidate number:</p>
<pre><code class="language-bash">dev/source-release.sh 0.8.1 0
</code></pre>
<pre><code>Preparing source for apache-iceberg-0.8.1-rc0
...
Success! The release candidate is available here:
  https://dist.apache.org/repos/dist/dev/iceberg/apache-iceberg-0.8.1-rc0/

Commit SHA1: 4b4716c76559b3cdf3487e6b60ab52950241989b
</code></pre>
<p>The source release script will create a candidate tag based on the HEAD revision in git and will prepare the release tarball, signature, and checksum files. It will also upload the source artifacts to SVN.</p>
<p>Note the commit SHA1 and candidate location because those will be added to the vote thread.</p>
<p>Once the source release is ready, use it to stage convenience binary artifacts in Nexus.</p>
<h3 id="build-and-stage-convenience-binaries">Build and stage convenience binaries<a class="headerlink" href="#build-and-stage-convenience-binaries" title="Permanent link">&para;</a></h3>
<p>Convenience binaries are created using the source release tarball from in the last step.</p>
<p>Untar the source release and go into the release directory:</p>
<pre><code class="language-bash">tar xzf apache-iceberg-0.8.1.tar.gz
cd apache-iceberg-0.8.1
</code></pre>
<p>To build and publish the convenience binaries, run the <code>dev/stage-binaries.sh</code> script. This will push to a release staging repository.</p>
<pre><code>dev/stage-binaries.sh
</code></pre>
<p>Next, you need to close the staging repository:</p>
<ol>
<li>Go to <a href="https://repository.apache.org/">Nexus</a> and log in</li>
<li>In the menu on the left, choose &ldquo;Staging Repositories&rdquo;</li>
<li>Select the Iceberg repository</li>
<li>At the top, select &ldquo;Close&rdquo; and follow the instructions<ul>
<li>In the comment field use &ldquo;Apache Iceberg &lt;version&gt; RC&lt;num&gt;&ldquo;</li>
</ul>
</li>
</ol>
<h3 id="start-a-vote-thread">Start a VOTE thread<a class="headerlink" href="#start-a-vote-thread" title="Permanent link">&para;</a></h3>
<p>The last step for a candidate is to create a VOTE thread on the dev mailing list.</p>
<pre><code class="language-text">Subject: [VOTE] Release Apache Iceberg &lt;VERSION&gt; RC&lt;NUM&gt;
</code></pre>
<pre><code class="language-text">Hi everyone,

I propose the following RC to be released as official Apache Iceberg &lt;VERSION&gt; release.

The commit id is &lt;SHA1&gt;
* This corresponds to the tag: apache-iceberg-&lt;VERSION&gt;-rc&lt;NUM&gt;
* https://github.com/apache/iceberg/commits/apache-iceberg-&lt;VERSION&gt;-rc&lt;NUM&gt;
* https://github.com/apache/iceberg/tree/&lt;SHA1&gt;

The release tarball, signature, and checksums are here:
* https://dist.apache.org/repos/dist/dev/iceberg/apache-iceberg-&lt;VERSION&gt;-rc&lt;NUM&gt;/

You can find the KEYS file here:
* https://dist.apache.org/repos/dist/dev/iceberg/KEYS

Convenience binary artifacts are staged in Nexus. The Maven repository URL is:
* https://repository.apache.org/content/repositories/orgapacheiceberg-&lt;ID&gt;/

This release includes important changes that I should have summarized here, but I'm lazy.

Please download, verify, and test.

Please vote in the next 72 hours.

[ ] +1 Release this as Apache Iceberg &lt;VERSION&gt;
[ ] +0
[ ] -1 Do not release this because...
</code></pre>
<p>When a candidate is passed or rejected, reply with the voting result:</p>
<pre><code class="language-text">Subject: [RESULT][VOTE] Release Apache Iceberg &lt;VERSION&gt; RC&lt;NUM&gt;
</code></pre>
<pre><code class="language-text">Thanks everyone who participated in the vote for Release Apache Iceberg &lt;VERSION&gt; RC&lt;NUM&gt;.

The vote result is:

+1: 3 (binding), 5 (non-binding)
+0: 0 (binding), 0 (non-binding)
-1: 0 (binding), 0 (non-binding)

Therefore, the release candidate is passed/rejected.
</code></pre>
<h3 id="finishing-the-release">Finishing the release<a class="headerlink" href="#finishing-the-release" title="Permanent link">&para;</a></h3>
<p>After the release vote has passed, you need to release the last candidate&rsquo;s artifacts.</p>
<p>First, copy the source release directory to releases:</p>
<pre><code class="language-bash">mkdir iceberg
cd iceberg
svn co https://dist.apache.org/repos/dist/dev/iceberg candidates
svn co https://dist.apache.org/repos/dist/release/iceberg releases
cp -r candidates/apache-iceberg-&lt;VERSION&gt;-rcN/ releases/apache-iceberg-&lt;VERSION&gt;
cd releases
svn add apache-iceberg-&lt;VERSION&gt;
svn ci -m 'Iceberg: Add release &lt;VERSION&gt;'
</code></pre>
<p>Next, add a release tag to the git repository based on the passing candidate tag:</p>
<pre><code class="language-bash">git tag -am 'Release Apache Iceberg &lt;VERSION&gt;' apache-iceberg-&lt;VERSION&gt; apache-iceberg-&lt;VERSION&gt;-rcN
</code></pre>
<p>Then release the candidate repository in <a href="https://repository.apache.org/#stagingRepositories">Nexus</a>.</p>
<p>To announce the release, wait until Maven central has mirrored the Apache binaries, then update the Iceberg site and send an announcement email:</p>
<pre><code class="language-text">[ANNOUNCE] Apache Iceberg release &lt;VERSION&gt;
</code></pre>
<pre><code class="language-text">I'm please to announce the release of Apache Iceberg &lt;VERSION&gt;!

Apache Iceberg is an open table format for huge analytic datasets. Iceberg
delivers high query performance for tables with tens of petabytes of data,
along with atomic commits, concurrent writes, and SQL-compatible table
evolution.

This release can be downloaded from: https://www.apache.org/dyn/closer.cgi/iceberg/&lt;TARBALL NAME WITHOUT .tar.gz&gt;/&lt;TARBALL NAME&gt;

Java artifacts are available from Maven Central.

Thanks to everyone for contributing!
</code></pre>

  <br>
</div>

<footer class="container-fluid wm-page-content"><p>Copyright 2018-2021 <a href='https://www.apache.org/'>The Apache Software Foundation</a><br />Apache Iceberg, Iceberg, Apache, the Apache feather logo, and the Apache Iceberg project logo are either registered<br />trademarks or trademarks of The Apache Software Foundation in the United States and other countries.</p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>